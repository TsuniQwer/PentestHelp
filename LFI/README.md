# LFI

Local File Inclusion (LFI) allows an attacker to include files on a server through the web browser. This vulnerability exists when a web application includes a file without correctly sanitising the input, allowing and attacker to manipulate the input and inject path traversal characters and include other files from the web server.

## Example:
```
/script.php?page=index.html
```

A penetration tester would attempt to exploit this vulnerability by manipulating the file location parameter, such as:

```
/script.php?page=../../../../../../../../etc/passwd
```

The above is an effort to display the contents of the /etc/passwd file on a UNIX / Linux based system.

Below is an example of a successful exploitation of an LFI vulnerability on a web application:

### PHP Wrappers

PHP has a number of wrappers that can often be abused to bypass various input filters.

### PHP Expect Wrapper

PHP expect:// allows execution of system commands, unfortunately the expect PHP module is not enabled by default.

```
php?page=expect://ls
```
The payload is sent in a POST request to the server such as:
```
/fi/?page=php://input&cmd=ls
```

## Tools:

### dotdotpwn

```
dotdotpwn -m http -h (url)
```
